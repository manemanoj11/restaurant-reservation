{"ast":null,"code":"import _objectSpread from\"C:/Users/manem/OneDrive/Desktop/restaurant-reservation/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useState}from'react';import axios from'axios';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function Dashboard(_ref){let{user}=_ref;const[reservations,setReservations]=useState([]);const[form,setForm]=useState({date:'',time:'18:00',guests:2});const token=user.token;const config={headers:{Authorization:\"Bearer \".concat(token)}};useEffect(()=>{fetchReservations();},[]);const fetchReservations=async()=>{try{const res=await axios.get('http://localhost:5000/api/reservations',config);console.log('Fetched reservations:',res.data);setReservations(res.data);}catch(err){console.error('Error fetching reservations:',err);}};const handleBook=async e=>{e.preventDefault();try{await axios.post('http://localhost:5000/api/reservations',_objectSpread(_objectSpread({},form),{},{customerName:user.name}),config);alert('Booked!');fetchReservations();}catch(err){var _err$response,_err$response$data;alert(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.message)||'Error booking');}};const handleCancel=async id=>{if(!window.confirm('Cancel reservation?'))return;try{await axios.delete(\"http://localhost:5000/api/reservations/\".concat(id),config);fetchReservations();}catch(err){alert('Error cancelling');}};return/*#__PURE__*/_jsxs(\"div\",{style:{padding:'20px'},children:[/*#__PURE__*/_jsx(\"h3\",{children:['admin','manager','staff'].includes(user.role)?'All Reservations':'My Reservations'}),user.role==='customer'&&/*#__PURE__*/_jsxs(\"div\",{style:{border:'1px solid #ddd',padding:'15px',marginBottom:'20px'},children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Make a Reservation\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleBook,style:{display:'flex',gap:'10px'},children:[/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:form.date,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{date:e.target.value})),required:true}),/*#__PURE__*/_jsxs(\"select\",{value:form.time,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{time:e.target.value})),children:[/*#__PURE__*/_jsx(\"option\",{value:\"17:00\",children:\"17:00\"}),/*#__PURE__*/_jsx(\"option\",{value:\"18:00\",children:\"18:00\"}),/*#__PURE__*/_jsx(\"option\",{value:\"19:00\",children:\"19:00\"}),/*#__PURE__*/_jsx(\"option\",{value:\"20:00\",children:\"20:00\"})]}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:\"1\",value:form.guests,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{guests:e.target.value})),style:{width:'60px'}}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Book\"})]})]}),/*#__PURE__*/_jsxs(\"table\",{style:{width:'100%',borderCollapse:'collapse'},border:\"1\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Date\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Time\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Table\"}),['admin','manager','staff'].includes(user.role)&&/*#__PURE__*/_jsx(\"th\",{children:\"Customer\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Action\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:reservations.map(res=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:res.date}),/*#__PURE__*/_jsx(\"td\",{children:res.time}),/*#__PURE__*/_jsx(\"td\",{children:res.tableName}),['admin','manager','staff'].includes(user.role)&&/*#__PURE__*/_jsx(\"td\",{children:res.customerName}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleCancel(res._id),style:{color:'red'},children:\"Cancel\"})})]},res._id))})]})]});}","map":{"version":3,"names":["React","useEffect","useState","axios","jsx","_jsx","jsxs","_jsxs","Dashboard","_ref","user","reservations","setReservations","form","setForm","date","time","guests","token","config","headers","Authorization","concat","fetchReservations","res","get","console","log","data","err","error","handleBook","e","preventDefault","post","_objectSpread","customerName","name","alert","_err$response","_err$response$data","response","message","handleCancel","id","window","confirm","delete","style","padding","children","includes","role","border","marginBottom","onSubmit","display","gap","type","value","onChange","target","required","min","width","borderCollapse","map","tableName","onClick","_id","color"],"sources":["C:/Users/manem/OneDrive/Desktop/restaurant-reservation/client/src/components/Dashboard.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport axios from 'axios';\r\n\r\nexport default function Dashboard({ user }) {\r\n  const [reservations, setReservations] = useState([]);\r\n  const [form, setForm] = useState({ date: '', time: '18:00', guests: 2 });\r\n  \r\n  const token = user.token;\r\n  const config = { headers: { Authorization: `Bearer ${token}` } };\r\n\r\n  useEffect(() => {\r\n    fetchReservations();\r\n  }, []);\r\n\r\n  const fetchReservations = async () => {\r\n    try {\r\n      const res = await axios.get('http://localhost:5000/api/reservations', config);\r\n      console.log('Fetched reservations:', res.data);\r\n      setReservations(res.data);\r\n    } catch (err) {\r\n      console.error('Error fetching reservations:', err);\r\n    }\r\n  };\r\n\r\n  const handleBook = async (e) => {\r\n    e.preventDefault();\r\n    try {\r\n      await axios.post('http://localhost:5000/api/reservations', \r\n        { ...form, customerName: user.name }, config\r\n      );\r\n      alert('Booked!');\r\n      fetchReservations();\r\n    } catch (err) {\r\n      alert(err.response?.data?.message || 'Error booking');\r\n    }\r\n  };\r\n\r\n  const handleCancel = async (id) => {\r\n    if (!window.confirm('Cancel reservation?')) return;\r\n    try {\r\n      await axios.delete(`http://localhost:5000/api/reservations/${id}`, config);\r\n      fetchReservations();\r\n    } catch (err) {\r\n      alert('Error cancelling');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div style={{ padding: '20px' }}>\r\n      <h3>{['admin', 'manager', 'staff'].includes(user.role) ? 'All Reservations' : 'My Reservations'}</h3>\r\n\r\n      {/* Booking Form - Only for customers */}\r\n      {user.role === 'customer' && (\r\n        <div style={{ border: '1px solid #ddd', padding: '15px', marginBottom: '20px' }}>\r\n          <h4>Make a Reservation</h4>\r\n          <form onSubmit={handleBook} style={{ display: 'flex', gap: '10px' }}>\r\n            <input type=\"date\" value={form.date} onChange={e => setForm({...form, date: e.target.value})} required />\r\n            <select value={form.time} onChange={e => setForm({...form, time: e.target.value})}>\r\n              <option value=\"17:00\">17:00</option>\r\n              <option value=\"18:00\">18:00</option>\r\n              <option value=\"19:00\">19:00</option>\r\n              <option value=\"20:00\">20:00</option>\r\n            </select>\r\n            <input type=\"number\" min=\"1\" value={form.guests} onChange={e => setForm({...form, guests: e.target.value})} style={{ width: '60px' }} />\r\n            <button type=\"submit\">Book</button>\r\n          </form>\r\n        </div>\r\n      )}\r\n\r\n      {/* Reservation List */}\r\n      <table style={{ width: '100%', borderCollapse: 'collapse' }} border=\"1\">\r\n        <thead>\r\n          <tr>\r\n            <th>Date</th>\r\n            <th>Time</th>\r\n            <th>Table</th>\r\n            {['admin', 'manager', 'staff'].includes(user.role) && <th>Customer</th>}\r\n            <th>Action</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {reservations.map(res => (\r\n            <tr key={res._id}>\r\n              <td>{res.date}</td>\r\n              <td>{res.time}</td>\r\n              <td>{res.tableName}</td>\r\n              {['admin', 'manager', 'staff'].includes(user.role) && <td>{res.customerName}</td>}\r\n              <td>\r\n                <button onClick={() => handleCancel(res._id)} style={{ color: 'red' }}>Cancel</button>\r\n              </td>\r\n            </tr>\r\n          ))}\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"kJAAA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAClD,MAAO,CAAAC,KAAK,KAAM,OAAO,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAE1B,cAAe,SAAS,CAAAC,SAASA,CAAAC,IAAA,CAAW,IAAV,CAAEC,IAAK,CAAC,CAAAD,IAAA,CACxC,KAAM,CAACE,YAAY,CAAEC,eAAe,CAAC,CAAGV,QAAQ,CAAC,EAAE,CAAC,CACpD,KAAM,CAACW,IAAI,CAAEC,OAAO,CAAC,CAAGZ,QAAQ,CAAC,CAAEa,IAAI,CAAE,EAAE,CAAEC,IAAI,CAAE,OAAO,CAAEC,MAAM,CAAE,CAAE,CAAC,CAAC,CAExE,KAAM,CAAAC,KAAK,CAAGR,IAAI,CAACQ,KAAK,CACxB,KAAM,CAAAC,MAAM,CAAG,CAAEC,OAAO,CAAE,CAAEC,aAAa,WAAAC,MAAA,CAAYJ,KAAK,CAAG,CAAE,CAAC,CAEhEjB,SAAS,CAAC,IAAM,CACdsB,iBAAiB,CAAC,CAAC,CACrB,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAA,iBAAiB,CAAG,KAAAA,CAAA,GAAY,CACpC,GAAI,CACF,KAAM,CAAAC,GAAG,CAAG,KAAM,CAAArB,KAAK,CAACsB,GAAG,CAAC,wCAAwC,CAAEN,MAAM,CAAC,CAC7EO,OAAO,CAACC,GAAG,CAAC,uBAAuB,CAAEH,GAAG,CAACI,IAAI,CAAC,CAC9ChB,eAAe,CAACY,GAAG,CAACI,IAAI,CAAC,CAC3B,CAAE,MAAOC,GAAG,CAAE,CACZH,OAAO,CAACI,KAAK,CAAC,8BAA8B,CAAED,GAAG,CAAC,CACpD,CACF,CAAC,CAED,KAAM,CAAAE,UAAU,CAAG,KAAO,CAAAC,CAAC,EAAK,CAC9BA,CAAC,CAACC,cAAc,CAAC,CAAC,CAClB,GAAI,CACF,KAAM,CAAA9B,KAAK,CAAC+B,IAAI,CAAC,wCAAwC,CAAAC,aAAA,CAAAA,aAAA,IAClDtB,IAAI,MAAEuB,YAAY,CAAE1B,IAAI,CAAC2B,IAAI,GAAIlB,MACxC,CAAC,CACDmB,KAAK,CAAC,SAAS,CAAC,CAChBf,iBAAiB,CAAC,CAAC,CACrB,CAAE,MAAOM,GAAG,CAAE,KAAAU,aAAA,CAAAC,kBAAA,CACZF,KAAK,CAAC,EAAAC,aAAA,CAAAV,GAAG,CAACY,QAAQ,UAAAF,aAAA,kBAAAC,kBAAA,CAAZD,aAAA,CAAcX,IAAI,UAAAY,kBAAA,iBAAlBA,kBAAA,CAAoBE,OAAO,GAAI,eAAe,CAAC,CACvD,CACF,CAAC,CAED,KAAM,CAAAC,YAAY,CAAG,KAAO,CAAAC,EAAE,EAAK,CACjC,GAAI,CAACC,MAAM,CAACC,OAAO,CAAC,qBAAqB,CAAC,CAAE,OAC5C,GAAI,CACF,KAAM,CAAA3C,KAAK,CAAC4C,MAAM,2CAAAzB,MAAA,CAA2CsB,EAAE,EAAIzB,MAAM,CAAC,CAC1EI,iBAAiB,CAAC,CAAC,CACrB,CAAE,MAAOM,GAAG,CAAE,CACZS,KAAK,CAAC,kBAAkB,CAAC,CAC3B,CACF,CAAC,CAED,mBACE/B,KAAA,QAAKyC,KAAK,CAAE,CAAEC,OAAO,CAAE,MAAO,CAAE,CAAAC,QAAA,eAC9B7C,IAAA,OAAA6C,QAAA,CAAK,CAAC,OAAO,CAAE,SAAS,CAAE,OAAO,CAAC,CAACC,QAAQ,CAACzC,IAAI,CAAC0C,IAAI,CAAC,CAAG,kBAAkB,CAAG,iBAAiB,CAAK,CAAC,CAGpG1C,IAAI,CAAC0C,IAAI,GAAK,UAAU,eACvB7C,KAAA,QAAKyC,KAAK,CAAE,CAAEK,MAAM,CAAE,gBAAgB,CAAEJ,OAAO,CAAE,MAAM,CAAEK,YAAY,CAAE,MAAO,CAAE,CAAAJ,QAAA,eAC9E7C,IAAA,OAAA6C,QAAA,CAAI,oBAAkB,CAAI,CAAC,cAC3B3C,KAAA,SAAMgD,QAAQ,CAAExB,UAAW,CAACiB,KAAK,CAAE,CAAEQ,OAAO,CAAE,MAAM,CAAEC,GAAG,CAAE,MAAO,CAAE,CAAAP,QAAA,eAClE7C,IAAA,UAAOqD,IAAI,CAAC,MAAM,CAACC,KAAK,CAAE9C,IAAI,CAACE,IAAK,CAAC6C,QAAQ,CAAE5B,CAAC,EAAIlB,OAAO,CAAAqB,aAAA,CAAAA,aAAA,IAAKtB,IAAI,MAAEE,IAAI,CAAEiB,CAAC,CAAC6B,MAAM,CAACF,KAAK,EAAC,CAAE,CAACG,QAAQ,MAAE,CAAC,cACzGvD,KAAA,WAAQoD,KAAK,CAAE9C,IAAI,CAACG,IAAK,CAAC4C,QAAQ,CAAE5B,CAAC,EAAIlB,OAAO,CAAAqB,aAAA,CAAAA,aAAA,IAAKtB,IAAI,MAAEG,IAAI,CAAEgB,CAAC,CAAC6B,MAAM,CAACF,KAAK,EAAC,CAAE,CAAAT,QAAA,eAChF7C,IAAA,WAAQsD,KAAK,CAAC,OAAO,CAAAT,QAAA,CAAC,OAAK,CAAQ,CAAC,cACpC7C,IAAA,WAAQsD,KAAK,CAAC,OAAO,CAAAT,QAAA,CAAC,OAAK,CAAQ,CAAC,cACpC7C,IAAA,WAAQsD,KAAK,CAAC,OAAO,CAAAT,QAAA,CAAC,OAAK,CAAQ,CAAC,cACpC7C,IAAA,WAAQsD,KAAK,CAAC,OAAO,CAAAT,QAAA,CAAC,OAAK,CAAQ,CAAC,EAC9B,CAAC,cACT7C,IAAA,UAAOqD,IAAI,CAAC,QAAQ,CAACK,GAAG,CAAC,GAAG,CAACJ,KAAK,CAAE9C,IAAI,CAACI,MAAO,CAAC2C,QAAQ,CAAE5B,CAAC,EAAIlB,OAAO,CAAAqB,aAAA,CAAAA,aAAA,IAAKtB,IAAI,MAAEI,MAAM,CAAEe,CAAC,CAAC6B,MAAM,CAACF,KAAK,EAAC,CAAE,CAACX,KAAK,CAAE,CAAEgB,KAAK,CAAE,MAAO,CAAE,CAAE,CAAC,cACxI3D,IAAA,WAAQqD,IAAI,CAAC,QAAQ,CAAAR,QAAA,CAAC,MAAI,CAAQ,CAAC,EAC/B,CAAC,EACJ,CACN,cAGD3C,KAAA,UAAOyC,KAAK,CAAE,CAAEgB,KAAK,CAAE,MAAM,CAAEC,cAAc,CAAE,UAAW,CAAE,CAACZ,MAAM,CAAC,GAAG,CAAAH,QAAA,eACrE7C,IAAA,UAAA6C,QAAA,cACE3C,KAAA,OAAA2C,QAAA,eACE7C,IAAA,OAAA6C,QAAA,CAAI,MAAI,CAAI,CAAC,cACb7C,IAAA,OAAA6C,QAAA,CAAI,MAAI,CAAI,CAAC,cACb7C,IAAA,OAAA6C,QAAA,CAAI,OAAK,CAAI,CAAC,CACb,CAAC,OAAO,CAAE,SAAS,CAAE,OAAO,CAAC,CAACC,QAAQ,CAACzC,IAAI,CAAC0C,IAAI,CAAC,eAAI/C,IAAA,OAAA6C,QAAA,CAAI,UAAQ,CAAI,CAAC,cACvE7C,IAAA,OAAA6C,QAAA,CAAI,QAAM,CAAI,CAAC,EACb,CAAC,CACA,CAAC,cACR7C,IAAA,UAAA6C,QAAA,CACGvC,YAAY,CAACuD,GAAG,CAAC1C,GAAG,eACnBjB,KAAA,OAAA2C,QAAA,eACE7C,IAAA,OAAA6C,QAAA,CAAK1B,GAAG,CAACT,IAAI,CAAK,CAAC,cACnBV,IAAA,OAAA6C,QAAA,CAAK1B,GAAG,CAACR,IAAI,CAAK,CAAC,cACnBX,IAAA,OAAA6C,QAAA,CAAK1B,GAAG,CAAC2C,SAAS,CAAK,CAAC,CACvB,CAAC,OAAO,CAAE,SAAS,CAAE,OAAO,CAAC,CAAChB,QAAQ,CAACzC,IAAI,CAAC0C,IAAI,CAAC,eAAI/C,IAAA,OAAA6C,QAAA,CAAK1B,GAAG,CAACY,YAAY,CAAK,CAAC,cACjF/B,IAAA,OAAA6C,QAAA,cACE7C,IAAA,WAAQ+D,OAAO,CAAEA,CAAA,GAAMzB,YAAY,CAACnB,GAAG,CAAC6C,GAAG,CAAE,CAACrB,KAAK,CAAE,CAAEsB,KAAK,CAAE,KAAM,CAAE,CAAApB,QAAA,CAAC,QAAM,CAAQ,CAAC,CACpF,CAAC,GAPE1B,GAAG,CAAC6C,GAQT,CACL,CAAC,CACG,CAAC,EACH,CAAC,EACL,CAAC,CAEV","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}